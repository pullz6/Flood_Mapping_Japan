var before_startdate = '2024-08-31'
var before_enddate = '2024-09-20'
var after_startdate = '2024-09-20'
var after_enddate = '2024-09-30'

var admin2 = ee.FeatureCollection("FAO/GAUL_SIMPLIFIED_500m/2015/level1")
var ishikawa = admin2.filter(ee.Filter.eq('ADM1_NAME', 'Isikawa'));
var geometry = ishikawa.geometry()
Map.addLayer(geometry,{color:'grey'},'Ishikawa')
Map.centerObject(geometry);

var filtered = s1
  .filter(ee.Filter.eq('instrumentMode','IW'))
  .filter(ee.Filter.listContains('transmitterReceiverPolarisation','VV'))
  .filter(ee.Filter.listContains('transmitterReceiverPolarisation','VH'))
  .filter(ee.Filter.eq('orbitProperties_pass','DESCENDING'))
  .filter(ee.Filter.bounds(geometry))
  .select(['VH','VV']);

var beforecollection = filtered.filter(ee.Filter.date(before_startdate,before_enddate))
var aftercollection = filtered.filter(ee.Filter.date(after_startdate,after_enddate))

var before = beforecollection.mosaic().clip(geometry)
var after = aftercollection.mosaic().clip(geometry)


var addratioband = function(image){
  var ratioBand = image.select('VV').divide(image.select('VH')).rename('VV/VH')
  return image.addBands(ratioBand)
}

var beforergb = addratioband(before)
var afterrgb = addratioband(after)

print(beforergb)

var visParams = {
  min : [-25,-25,0],
  max : [0,0,2]
}

Map.addLayer(beforergb,visParams,'Before')
Map.addLayer(afterrgb,visParams,'After') 
